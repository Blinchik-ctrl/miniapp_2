import React, { useState, useEffect } from 'react';
import { Users, Calendar, MapPin, Heart, MessageCircle, Search, Plus, TrendingUp } from 'lucide-react';

export default function InterestsApp() {
  const [currentView, setCurrentView] = useState('feed');
  const [selectedCategory, setSelectedCategory] = useState('all');
  const [userProfile, setUserProfile] = useState({
    name: '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä',
    avatar: 'üë®‚Äçüíº',
    interests: ['–ö–æ—Ñ–µ', 'IT', '–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è']
  });

  const [events, setEvents] = useState([
    {
      id: 1,
      title: '–ö–æ—Ñ–µ –∏ –Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥',
      category: 'coffee',
      creator: '–ú–∞—Ä–∏—è',
      creatorAvatar: 'üë©',
      participants: 4,
      maxParticipants: 8,
      date: '20 –æ–∫—Ç—è–±—Ä—è',
      time: '18:00',
      location: '–ö–æ—Ñ–µ–π–Ω—è "Beans"',
      description: '–í—Å—Ç—Ä–µ—Ç–∏–º—Å—è, –ø–æ–æ–±—â–∞–µ–º—Å—è –∑–∞ —á–∞—à–µ—á–∫–æ–π –∫–æ—Ñ–µ',
      likes: 12,
      isLiked: false
    },
    {
      id: 2,
      title: '–•–∞–π–∫–∏–Ω–≥ –≤ –≥–æ—Ä—ã',
      category: 'sport',
      creator: '–î–º–∏—Ç—Ä–∏–π',
      creatorAvatar: 'üßî',
      participants: 6,
      maxParticipants: 10,
      date: '22 –æ–∫—Ç—è–±—Ä—è',
      time: '08:00',
      location: '–ê–ª–∞-–ê—Ä—á–∞',
      description: '–ü–æ—Ö–æ–¥ –Ω–∞ —Ü–µ–ª—ã–π –¥–µ–Ω—å, –±–µ—Ä–µ–º –µ–¥—É —Å —Å–æ–±–æ–π',
      likes: 24,
      isLiked: true
    },
    {
      id: 3,
      title: '–ù–∞—Å—Ç–æ–ª—å–Ω—ã–µ –∏–≥—Ä—ã',
      category: 'games',
      creator: '–ê–Ω–Ω–∞',
      creatorAvatar: 'üë©‚Äçü¶∞',
      participants: 3,
      maxParticipants: 6,
      date: '19 –æ–∫—Ç—è–±—Ä—è',
      time: '19:00',
      location: 'Anticafe "Time"',
      description: '–ò–≥—Ä–∞–µ–º –≤ –ö–∞—Ä–∫–∞—Å—Å–æ–Ω –∏ –ú–æ–Ω–æ–ø–æ–ª–∏—é',
      likes: 8,
      isLiked: false
    },
    {
      id: 4,
      title: 'IT-meetup',
      category: 'tech',
      creator: '–°–µ—Ä–≥–µ–π',
      creatorAvatar: 'üë®‚Äçüíª',
      participants: 12,
      maxParticipants: 20,
      date: '21 –æ–∫—Ç—è–±—Ä—è',
      time: '17:00',
      location: 'CoWorking Space',
      description: '–û–±—Å—É–∂–¥–∞–µ–º –Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –¥–µ–ª–∏–º—Å—è –æ–ø—ã—Ç–æ–º',
      likes: 31,
      isLiked: true
    }
  ]);

  const categories = [
    { id: 'all', name: '–í—Å–µ', icon: 'üåü', color: 'bg-purple-500' },
    { id: 'coffee', name: '–ö–æ—Ñ–µ', icon: '‚òï', color: 'bg-amber-600' },
    { id: 'sport', name: '–°–ø–æ—Ä—Ç', icon: '‚öΩ', color: 'bg-green-500' },
    { id: 'games', name: '–ò–≥—Ä—ã', icon: 'üéÆ', color: 'bg-blue-500' },
    { id: 'tech', name: 'IT', icon: 'üíª', color: 'bg-indigo-500' },
    { id: 'art', name: '–ò—Å–∫—É—Å—Å—Ç–≤–æ', icon: 'üé®', color: 'bg-pink-500' }
  ];

  const filteredEvents = selectedCategory === 'all'
    ? events
    : events.filter(e => e.category === selectedCategory);

  const handleLike = (eventId) => {
    setEvents(events.map(event =>
      event.id === eventId
        ? { ...event, likes: event.isLiked ? event.likes - 1 : event.likes + 1, isLiked: !event.isLiked }
        : event
    ));
  };

  const handleJoinEvent = (eventId) => {
    setEvents(events.map(event =>
      event.id === eventId && event.participants < event.maxParticipants
        ? { ...event, participants: event.participants + 1 }
        : event
    ));
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-50 to-blue-50">
      {/* Header */}
      <div className="bg-white shadow-sm sticky top-0 z-10">
        <div className="max-w-4xl mx-auto px-4 py-4">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <div className="text-3xl">{userProfile.avatar}</div>
              <div>
                <h1 className="text-xl font-bold text-gray-800">–ü—Ä–∏–≤–µ—Ç, {userProfile.name}!</h1>
                <p className="text-sm text-gray-500">–ù–∞–π–¥–∏ –∫–æ–º–ø–∞–Ω–∏—é –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º</p>
              </div>
            </div>
            <button
              onClick={() => setCurrentView('create')}
              className="bg-gradient-to-r from-purple-500 to-blue-500 text-white p-3 rounded-full shadow-lg hover:shadow-xl transition-all"
            >
              <Plus className="w-5 h-5" />
            </button>
          </div>
        </div>
      </div>

      {/* Categories */}
      <div className="bg-white border-b sticky top-[72px] z-10">
        <div className="max-w-4xl mx-auto px-4 py-3 overflow-x-auto">
          <div className="flex gap-2">
            {categories.map(cat => (
              <button
                key={cat.id}
                onClick={() => setSelectedCategory(cat.id)}
                className={`flex items-center gap-2 px-4 py-2 rounded-full whitespace-nowrap transition-all ${
                  selectedCategory === cat.id
                    ? `${cat.color} text-white shadow-md`
                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                }`}
              >
                <span className="text-lg">{cat.icon}</span>
                <span className="font-medium">{cat.name}</span>
              </button>
            ))}
          </div>
        </div>
      </div>

      {/* Main Content */}
      <div className="max-w-4xl mx-auto px-4 py-6">
        {currentView === 'feed' && (
          <div className="space-y-4">
            {/* Trending Section */}
            <div className="bg-gradient-to-r from-orange-400 to-pink-500 rounded-2xl p-4 text-white shadow-lg">
              <div className="flex items-center gap-2 mb-2">
                <TrendingUp className="w-5 h-5" />
                <h2 className="font-bold text-lg">–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ —Å–µ–≥–æ–¥–Ω—è</h2>
              </div>
              <p className="text-sm opacity-90">12 –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π ¬∑ 48 —á–µ–ª–æ–≤–µ–∫ –∏—â—É—Ç –∫–æ–º–ø–∞–Ω–∏—é</p>
            </div>

            {/* Events List */}
            {filteredEvents.map(event => (
              <div key={event.id} className="bg-white rounded-2xl shadow-md hover:shadow-xl transition-all overflow-hidden">
                <div className="p-4">
                  <div className="flex items-start justify-between mb-3">
                    <div className="flex items-center gap-3">
                      <div className="text-3xl">{event.creatorAvatar}</div>
                      <div>
                        <h3 className="font-bold text-gray-800">{event.creator}</h3>
                        <p className="text-sm text-gray-500">–æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä</p>
                      </div>
                    </div>
                    <button
                      onClick={() => handleLike(event.id)}
                      className={`p-2 rounded-full transition-all ${
                        event.isLiked ? 'bg-red-50' : 'bg-gray-50 hover:bg-gray-100'
                      }`}
                    >
                      <Heart className={`w-5 h-5 ${event.isLiked ? 'fill-red-500 text-red-500' : 'text-gray-400'}`} />
                    </button>
                  </div>

                  <h2 className="text-xl font-bold text-gray-900 mb-2">{event.title}</h2>
                  <p className="text-gray-600 mb-4">{event.description}</p>

                  <div className="space-y-2 mb-4">
                    <div className="flex items-center gap-2 text-gray-700">
                      <Calendar className="w-4 h-4 text-purple-500" />
                      <span className="text-sm">{event.date} –≤ {event.time}</span>
                    </div>
                    <div className="flex items-center gap-2 text-gray-700">
                      <MapPin className="w-4 h-4 text-red-500" />
                      <span className="text-sm">{event.location}</span>
                    </div>
                    <div className="flex items-center gap-2 text-gray-700">
                      <Users className="w-4 h-4 text-blue-500" />
                      <span className="text-sm">{event.participants} / {event.maxParticipants} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</span>
                    </div>
                  </div>

                  {/* Progress Bar */}
                  <div className="mb-4">
                    <div className="w-full bg-gray-200 rounded-full h-2">
                      <div
                        className="bg-gradient-to-r from-purple-500 to-blue-500 h-2 rounded-full transition-all"
                        style={{ width: `${(event.participants / event.maxParticipants) * 100}%` }}
                      />
                    </div>
                  </div>

                  <div className="flex gap-2">
                    <button
                      onClick={() => handleJoinEvent(event.id)}
                      disabled={event.participants >= event.maxParticipants}
                      className={`flex-1 py-3 rounded-xl font-semibold transition-all ${
                        event.participants >= event.maxParticipants
                          ? 'bg-gray-200 text-gray-500 cursor-not-allowed'
                          : 'bg-gradient-to-r from-purple-500 to-blue-500 text-white hover:shadow-lg'
                      }`}
                    >
                      {event.participants >= event.maxParticipants ? '–ú–µ—Å—Ç –Ω–µ—Ç' : '–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è'}
                    </button>
                    <button className="px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-all">
                      <MessageCircle className="w-5 h-5 text-gray-600" />
                    </button>
                  </div>

                  <div className="flex items-center gap-4 mt-3 pt-3 border-t text-sm text-gray-500">
                    <span>{event.likes} –Ω—Ä–∞–≤–∏—Ç—Å—è</span>
                    <span>¬∑</span>
                    <span>24 –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</span>
                  </div>
                </div>
              </div>
            ))}
          </div>
        )}

        {currentView === 'create' && (
          <div className="bg-white rounded-2xl shadow-lg p-6">
            <h2 className="text-2xl font-bold text-gray-800 mb-6">–°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ</h2>

            <div className="space-y-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                <input
                  type="text"
                  placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ö–æ—Ñ–µ –∏ –æ–±—â–µ–Ω–∏–µ"
                  className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                <div className="grid grid-cols-3 gap-2">
                  {categories.filter(c => c.id !== 'all').map(cat => (
                    <button
                      key={cat.id}
                      className="flex flex-col items-center gap-1 p-3 border-2 border-gray-200 rounded-xl hover:border-purple-500 transition-all"
                    >
                      <span className="text-2xl">{cat.icon}</span>
                      <span className="text-xs font-medium">{cat.name}</span>
                    </button>
                  ))}
                </div>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                <textarea
                  rows="3"
                  placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–æ–±—ã—Ç–∏–∏..."
                  className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                />
              </div>

              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">–î–∞—Ç–∞</label>
                  <input
                    type="date"
                    className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-2">–í—Ä–µ–º—è</label>
                  <input
                    type="time"
                    className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                  />
                </div>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">–ú–µ—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∏</label>
                <input
                  type="text"
                  placeholder="–ê–¥—Ä–µ—Å –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞"
                  className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                />
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">–ú–∞–∫—Å–∏–º—É–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</label>
                <input
                  type="number"
                  placeholder="10"
                  className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                />
              </div>

              <div className="flex gap-3 pt-4">
                <button
                  onClick={() => setCurrentView('feed')}
                  className="flex-1 py-3 bg-gray-100 text-gray-700 rounded-xl font-semibold hover:bg-gray-200 transition-all"
                >
                  –û—Ç–º–µ–Ω–∞
                </button>
                <button
                  onClick={() => setCurrentView('feed')}
                  className="flex-1 py-3 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-xl font-semibold hover:shadow-lg transition-all"
                >
                  –°–æ–∑–¥–∞—Ç—å
                </button>
              </div>
            </div>
          </div>
        )}
      </div>

      {/* Bottom Navigation */}
      <div className="fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg">
        <div className="max-w-4xl mx-auto px-4 py-3">
          <div className="flex justify-around">
            <button
              onClick={() => setCurrentView('feed')}
              className={`flex flex-col items-center gap-1 ${currentView === 'feed' ? 'text-purple-500' : 'text-gray-400'}`}
            >
              <Users className="w-6 h-6" />
              <span className="text-xs font-medium">–°–æ–±—ã—Ç–∏—è</span>
            </button>
            <button className="flex flex-col items-center gap-1 text-gray-400">
              <Search className="w-6 h-6" />
              <span className="text-xs font-medium">–ü–æ–∏—Å–∫</span>
            </button>
            <button className="flex flex-col items-center gap-1 text-gray-400">
              <MessageCircle className="w-6 h-6" />
              <span className="text-xs font-medium">–ß–∞—Ç—ã</span>
            </button>
            <button className="flex flex-col items-center gap-1 text-gray-400">
              <Heart className="w-6 h-6" />
              <span className="text-xs font-medium">–ü—Ä–æ—Ñ–∏–ª—å</span>
            </button>
          </div>
        </div>
      </div>

      {/* Spacing for bottom nav */}
      <div className="h-20" />
    </div>
  );
}