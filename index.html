<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–ù–∞–π–¥–∏ –∫–æ–º–ø–∞–Ω–∏—é</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      margin: 0; 
      padding: 0; 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      overflow-x: hidden;
    }
    .event-card { transition: all 0.3s ease; }
    .event-card:hover { transform: translateY(-2px); }
  </style>
</head>
<body>
  <div id="app"></div>
  
  <script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
    let tg = window.Telegram?.WebApp;
    if (tg) {
      tg.ready();
      tg.expand();
    }

    // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    let state = {
      currentView: 'feed',
      selectedCategory: 'all',
      events: [
        {
          id: 1,
          title: '–ö–æ—Ñ–µ –∏ –Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥',
          category: 'coffee',
          creator: '–ú–∞—Ä–∏—è',
          creatorAvatar: 'üë©',
          participants: 4,
          maxParticipants: 8,
          date: '20 –æ–∫—Ç—è–±—Ä—è',
          time: '18:00',
          location: '–ö–æ—Ñ–µ–π–Ω—è "Beans"',
          description: '–í—Å—Ç—Ä–µ—Ç–∏–º—Å—è, –ø–æ–æ–±—â–∞–µ–º—Å—è –∑–∞ —á–∞—à–µ—á–∫–æ–π –∫–æ—Ñ–µ',
          likes: 12,
          isLiked: false
        },
        {
          id: 2,
          title: '–•–∞–π–∫–∏–Ω–≥ –≤ –≥–æ—Ä—ã',
          category: 'sport',
          creator: '–î–º–∏—Ç—Ä–∏–π',
          creatorAvatar: 'üßî',
          participants: 6,
          maxParticipants: 10,
          date: '22 –æ–∫—Ç—è–±—Ä—è',
          time: '08:00',
          location: '–ê–ª–∞-–ê—Ä—á–∞',
          description: '–ü–æ—Ö–æ–¥ –Ω–∞ —Ü–µ–ª—ã–π –¥–µ–Ω—å, –±–µ—Ä–µ–º –µ–¥—É —Å —Å–æ–±–æ–π',
          likes: 24,
          isLiked: true
        },
        {
          id: 3,
          title: '–ù–∞—Å—Ç–æ–ª—å–Ω—ã–µ –∏–≥—Ä—ã',
          category: 'games',
          creator: '–ê–Ω–Ω–∞',
          creatorAvatar: 'üë©‚Äçü¶∞',
          participants: 3,
          maxParticipants: 6,
          date: '19 –æ–∫—Ç—è–±—Ä—è',
          time: '19:00',
          location: 'Anticafe "Time"',
          description: '–ò–≥—Ä–∞–µ–º –≤ –ö–∞—Ä–∫–∞—Å—Å–æ–Ω –∏ –ú–æ–Ω–æ–ø–æ–ª–∏—é',
          likes: 8,
          isLiked: false
        },
        {
          id: 4,
          title: 'IT-meetup',
          category: 'tech',
          creator: '–°–µ—Ä–≥–µ–π',
          creatorAvatar: 'üë®‚Äçüíª',
          participants: 12,
          maxParticipants: 20,
          date: '21 –æ–∫—Ç—è–±—Ä—è',
          time: '17:00',
          location: 'CoWorking Space',
          description: '–û–±—Å—É–∂–¥–∞–µ–º –Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –¥–µ–ª–∏–º—Å—è –æ–ø—ã—Ç–æ–º',
          likes: 31,
          isLiked: true
        }
      ]
    };

    const categories = [
      { id: 'all', name: '–í—Å–µ', icon: 'üåü' },
      { id: 'coffee', name: '–ö–æ—Ñ–µ', icon: '‚òï' },
      { id: 'sport', name: '–°–ø–æ—Ä—Ç', icon: '‚öΩ' },
      { id: 'games', name: '–ò–≥—Ä—ã', icon: 'üéÆ' },
      { id: 'tech', name: 'IT', icon: 'üíª' },
      { id: 'art', name: '–ò—Å–∫—É—Å—Å—Ç–≤–æ', icon: 'üé®' }
    ];

    function render() {
      const app = document.getElementById('app');
      const filteredEvents = state.selectedCategory === 'all' 
        ? state.events 
        : state.events.filter(e => e.category === state.selectedCategory);

      app.innerHTML = `
        <div class="min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 pb-24">
          <!-- Header -->
          <div class="bg-white shadow-sm sticky top-0 z-10">
            <div class="max-w-4xl mx-auto px-4 py-4">
              <div class="flex items-center justify-between">
                <div>
                  <h1 class="text-xl font-bold text-gray-800">–ù–∞–π–¥–∏ –∫–æ–º–ø–∞–Ω–∏—é</h1>
                  <p class="text-sm text-gray-500">–°–æ–±—ã—Ç–∏—è –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º</p>
                </div>
                <button onclick="createEvent()" class="bg-gradient-to-r from-purple-500 to-blue-500 text-white px-4 py-2 rounded-full shadow-lg text-sm font-semibold">
                  ‚ûï –°–æ–∑–¥–∞—Ç—å
                </button>
              </div>
            </div>
          </div>

          <!-- Categories -->
          <div class="bg-white border-b sticky top-[72px] z-10">
            <div class="max-w-4xl mx-auto px-4 py-3 overflow-x-auto">
              <div class="flex gap-2">
                ${categories.map(cat => `
                  <button
                    onclick="selectCategory('${cat.id}')"
                    class="flex items-center gap-2 px-4 py-2 rounded-full whitespace-nowrap transition-all ${
                      state.selectedCategory === cat.id 
                        ? 'bg-purple-500 text-white shadow-md' 
                        : 'bg-gray-100 text-gray-700'
                    }"
                  >
                    <span>${cat.icon}</span>
                    <span class="font-medium text-sm">${cat.name}</span>
                  </button>
                `).join('')}
              </div>
            </div>
          </div>

          <!-- Events -->
          <div class="max-w-4xl mx-auto px-4 py-6 space-y-4">
            <!-- Trending -->
            <div class="bg-gradient-to-r from-orange-400 to-pink-500 rounded-2xl p-4 text-white shadow-lg">
              <div class="flex items-center gap-2 mb-2">
                <span class="text-2xl">üìà</span>
                <h2 class="font-bold text-lg">–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ —Å–µ–≥–æ–¥–Ω—è</h2>
              </div>
              <p class="text-sm opacity-90">12 –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π ¬∑ 48 —á–µ–ª–æ–≤–µ–∫ –∏—â—É—Ç –∫–æ–º–ø–∞–Ω–∏—é</p>
            </div>

            ${filteredEvents.map(event => `
              <div class="event-card bg-white rounded-2xl shadow-md p-4">
                <div class="flex items-start justify-between mb-3">
                  <div class="flex items-center gap-3">
                    <div class="text-3xl">${event.creatorAvatar}</div>
                    <div>
                      <h3 class="font-bold text-gray-800">${event.creator}</h3>
                      <p class="text-sm text-gray-500">–æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä</p>
                    </div>
                  </div>
                  <button 
                    onclick="toggleLike(${event.id})"
                    class="p-2 rounded-full transition-all ${event.isLiked ? 'bg-red-50' : 'bg-gray-50'}"
                  >
                    <span class="${event.isLiked ? 'text-red-500' : 'text-gray-400'}">‚ù§Ô∏è</span>
                  </button>
                </div>

                <h2 class="text-xl font-bold text-gray-900 mb-2">${event.title}</h2>
                <p class="text-gray-600 mb-4">${event.description}</p>

                <div class="space-y-2 mb-4 text-sm">
                  <div class="flex items-center gap-2 text-gray-700">
                    <span>üìÖ</span>
                    <span>${event.date} –≤ ${event.time}</span>
                  </div>
                  <div class="flex items-center gap-2 text-gray-700">
                    <span>üìç</span>
                    <span>${event.location}</span>
                  </div>
                  <div class="flex items-center gap-2 text-gray-700">
                    <span>üë•</span>
                    <span>${event.participants} / ${event.maxParticipants} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</span>
                  </div>
                </div>

                <div class="mb-4">
                  <div class="w-full bg-gray-200 rounded-full h-2">
                    <div 
                      class="bg-gradient-to-r from-purple-500 to-blue-500 h-2 rounded-full transition-all"
                      style="width: ${(event.participants / event.maxParticipants) * 100}%"
                    ></div>
                  </div>
                </div>

                <button 
                  onclick="joinEvent(${event.id})"
                  ${event.participants >= event.maxParticipants ? 'disabled' : ''}
                  class="w-full py-3 rounded-xl font-semibold transition-all ${
                    event.participants >= event.maxParticipants
                      ? 'bg-gray-200 text-gray-500 cursor-not-allowed'
                      : 'bg-gradient-to-r from-purple-500 to-blue-500 text-white hover:shadow-lg'
                  }"
                >
                  ${event.participants >= event.maxParticipants ? '–ú–µ—Å—Ç –Ω–µ—Ç' : '–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è'}
                </button>

                <div class="flex items-center gap-4 mt-3 pt-3 border-t text-sm text-gray-500">
                  <span>‚ù§Ô∏è ${event.likes}</span>
                  <span>¬∑</span>
                  <span>üëÅÔ∏è ${Math.floor(Math.random() * 100)} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</span>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `;
    }

    function selectCategory(categoryId) {
      state.selectedCategory = categoryId;
      render();
    }

    function toggleLike(eventId) {
      state.events = state.events.map(event => {
        if (event.id === eventId) {
          return {
            ...event,
            likes: event.isLiked ? event.likes - 1 : event.likes + 1,
            isLiked: !event.isLiked
          };
        }
        return event;
      });
      render();
    }

    function joinEvent(eventId) {
      const event = state.events.find(e => e.id === eventId);
      if (event && event.participants < event.maxParticipants) {
        state.events = state.events.map(e => 
          e.id === eventId ? { ...e, participants: e.participants + 1 } : e
        );
        render();
        if (tg) {
          tg.showAlert('‚úÖ –í—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ —Å–æ–±—ã—Ç–∏—é!');
        } else {
          alert('‚úÖ –í—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ —Å–æ–±—ã—Ç–∏—é!');
        }
      }
    }

    function createEvent() {
      if (tg) {
        tg.showAlert('üìù –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è —Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è!');
      } else {
        alert('üìù –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è —Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è!');
      }
    }

    // –ü–µ—Ä–≤—ã–π —Ä–µ–Ω–¥–µ—Ä
    render();
  </script>
</body>
</html>
